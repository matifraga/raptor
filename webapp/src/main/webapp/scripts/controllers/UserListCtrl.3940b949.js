define(["AnguRaptor","directives/user-box"],function(a){a.controller("UserListCtrl",["$scope",function(a){var b={selected:0,items:[]};a.$watch("items",function(){b.items=[];for(var c=0;c<a.items.length;c++)b.items.push({users:[],busy:!1,page:1,fetchLimit:a.items[c].fetchLimit||15,nextPage:a.items[c].nextPage,title:a.items[c].title,disabled:!1})}),b.loadMore=function(){var a=b.items[b.selected];a.busy||a.disabled||(a.busy=!0,a.nextPage(a.page,a.fetchLimit).then(function(b){b.length<a.fetchLimit&&(a.disabled=!0);for(var c=0;c<b.length;c++)a.users.push(b[c]);a.page++,a.busy=!1})["catch"](function(){a.busy=!1,a.disabled=!0}))},b.switchSelection=function(a){a!==b.selected&&(b.selected=a,0===b.items[a].users.length&&b.loadMore())},a.userList=b}])});